<!DOCTYPE html>
<html xmlns:v-on="http://www.w3.org/1999/xhtml" xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>stock query</title>
    <link rel="stylesheet" href="/css/bootstrap/bootstrap.css"/>
    <link rel="stylesheet" href="/css/bootstrap/bootstrap-grid.css"/>
    <link rel="stylesheet" href="/css/bootstrap/bootstrap-reboot.css"/>
    <link rel="stylesheet" href="/css/vue/vuetable-2.css"/>
    <link ref="stylesheet" href="/css/fontawe/all.min.css"/>
    <link ref="stylesheet" href="/css/fontawe/v4-shims.min.css"/>

    <style>

        body {
            font-size: 0.8em;
        }

        .gone { display: none; }
        .s-bolxd { font-weight: bolder; }
        .s-tiny { font-size: 0.8em; }
        .s-up { color: red; }
        .s-down { color: forestgreen; }
        .s-grey { color: grey; }

    </style>
</head>
<body>

<div id="dcontainer" class="container"  style="max-width: 9999px"  >

    <!--
    <div class="qam-html-fragment nosuffix" include="../common/mask.html" v-if="!ready"></div>
    -->

    <!-- nav bar -->
    <div class="qam-html-fragment" include="q-nav.html"></div>

    <div id="div_tool" class="row" style="margin-top: 10px">

        <div aria-details="脚本" v-bind:class="{'col-md-4' :true, gone: !setting.display.script}" style="margin-top: 3px;">
            <div class="input-group-prepend">

                <button type="button" value="查询" class="btn btn-sm btn-info " v-on:click="script_query('hit'); ">
                    <i class="fa fa-search-dollar"></i>
                </button>
                <button type="button" value="反查询" class="btn btn-sm btn-outline-info " v-on:click="script_query('anti'); ">
                    <i class="fa fa-search-dollar"></i>
                </button>
                <button type="button" class="btn btn-outline-info dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="sr-only"></span>
                </button>
                <div class="dropdown-menu" id="dropdown_script">
                    <a class="dropdown-item" href="#" v-for="name in script_names" v-on:click="script_select(name)">
                    {{name}}
                    </a>
                </div>

                <input type="search" id="input_script_name" class="form-control"
                       placeholder="查询脚本" aria-label="script" aria-describedby="script" v-model="script.name" >
                <button type="button" value="测试" id="button_script_test" class="btn btn-sm btn-outline-info"  v-on:click="script_query('debug')" style="margin-left: 3px;">
                    <i class="fa fa-running"></i>
                </button>
                <button type="button" value="保存"  id="button_script_save" class="btn btn-sm btn-outline-info"  v-on:click="script_save()" >
                    <i class="fa fa-save"></i>
                </button>
                <button type="button" value="删除" class="btn btn-sm btn-outline-info" v-on:click="script_delete()">
                    <i class="fa fa-trash"></i>
                </button>
            </div>
        </div>

        <div aria-details="脚本参数" v-bind:class="{'col-md-4' :true, gone: !setting.display.script}" style="margin-top: 3px;">
            <div class="input-group-prepend">

                <button ar type="button" value="设置" id="button_script_test" class="btn btn-sm btn-outline-warning"  v-on:click="params_setting()" style="margin-left: 3px;">
                    <i class="fa fa-edit"></i>
                </button>
                <button type="button" class="btn btn-outline-warning dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="sr-only"></span>
                </button>
                <div class="dropdown-menu" id="dropdown_script">
                    <a class="dropdown-item" href="#" v-for="name in params_names" v-on:click="params_select(name)">
                    {{name}}
                    </a>
                </div>

                <input type="search" id="input_script_name" class="form-control"
                       placeholder="查询参数" aria-label="script" aria-describedby="script" v-model="params.name" >

                <button type="button" value="保存"  id="button_script_save" class="btn btn-sm btn-outline-warning"  v-on:click="params_update(); " >
                    <i class="fa fa-save"></i>
                </button>
                <button type="button" value="删除" class="btn btn-sm btn-outline-warning" v-on:click="params_delete()">
                    <i class="fa fa-trash"></i>
                </button>
            </div>
        </div>


        <div v-bind:class="{'col-md-4' :true, gone: !setting.display.portfolio}" style="margin-top: 3px;">
            <div class="input-group-prepend">
                
                <button type="button" id="button_portfolio_add" class="btn btn-sm btn-danger "  v-on:click="portfolio_view()">
                    <i class="fa fa-search-location"></i>
                </button>
                <button type="button" class="btn btn-outline-danger dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="sr-only"></span>
                </button>
                <div class="dropdown-menu" id="dropdown_portfolio">
                    <a class="dropdown-item" href="#" v-for="pname in portfolio_names" v-on:click="portfolio_select(pname)">
                    {{pname}}
                    </a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#" v-on:click="portfolio_add_manual()">
                        编码加入
                    </a>
                </div>

                <input type="search"  class="form-control" placeholder="自选组合" aria-label="portfolio" aria-describedby="portfolio"
                       v-model="portfolio.name" >
                <button type="button" value="新加" class="btn btn-sm btn-outline-danger"  v-on:click="portfolio_update()" style="margin-left: 3px;">
                    <i class="fa fa-plus-circle"></i>
                </button>
                <button type="button" value="移出" class="btn btn-sm btn-outline-danger"  v-on:click="portfolio_unadd()" >
                    <i class="fa fa-minus-circle"></i>
                </button>

                <button type="button" value="刪除" class="btn btn-sm btn-outline-danger" v-on:click="portfolio_delete()" >
                    <i class="fa fa-trash"></i>
                </button>
            </div>
        </div>

    </div>

    <div v-bind:class="{row :true, gone: !setting.display.editor}" style="margin-top: 10px;" >
        <div class="col-md-12" style="border: 1px solid #f0f0f0; border-radius: 5px">
            <pre id="editor" style="width: 100%; height: 120px;"><textarea></textarea></pre>
        </div>
    </div>

    <div v-bind:class="{row :true, gone: !setting.display.editor}" style="margin-top: 10px;" >
        <div class="col-md-12">
            <pre id="console" style="width: 100%; height: 100%; background-color: #eeeeee; border-radius: 5px; padding: 5px;">{{console.text}}</pre>
        </div>
    </div>


    <div id="div_table_pagination" style="margin-top: 5px;" v-bind:class="{'row' :true, gone: table.data.length <= setting.table.page_size }">
        <div class="col-sm-3 align-self-start">
            <div class="input-group sm-2">
                <div class="input-group-prepend">
                    <span class="input-group-text" style="background-color: white">total</span>
                </div>
                <input class="form-control sm-2" type="search" v-model="table.data.length" disable style="background-color: white" >
            </div>
        </div>
        <div class="col-sm-4 align-self-end" style="margin-left: 3px">
            <vuetable-pagination
                    ref="pagination"
                    :css="css.pagination"
                    @vuetable-pagination:change-page="table_paging_change"
            >
            </vuetable-pagination>
        </div>
        <div class="col-sm-2 align-self-end" style="margin-left: 10px">
            <div class="input-group sm-2">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon1" style="background-color: white">p</span>
                </div>
                <input class="form-control sm-1" type="search" v-model="setting.table.page_size">
            </div>
        </div>
    </div>

    <div id="div_table" class="row" style="margin-top: 5px;">
        <div class="col-md-12">
            <div id="table">
                <vuetable ref="vuetable"
                          table-wrapper="#table"
                          :css="css.table"
                          :api-mode="false"
                          :per-age="setting.table.page_size"
                          :fields="table_fields"
                          track-by="code"
                          :data-manager="table_data_manage"
                          :multi-sort="true"
                          multi-sort-key="ctrl"
                          pagination-path="pagination"
                          @vuetable:pagination-data="table_paging">
                ></vuetable>
            </div>
        </div>
    </div>



    <!-- table setting -->
    <div class="qam-html-fragment" include="q-table-setting.html"></div>

    <!-- params setting -->
    <div class="qam-html-fragment" include="q-param-setting.html"></div>

</div>


<!-- -->

<script type="text/javascript" src="/js/fontawe/solid.js" ></script>
<script type="text/javascript" src="/js/fontawe/fontawesome.js"></script>

<script type="text/javascript" src="/js/ace/ace.js"></script>
<script type="text/javascript" src="/js/axios/axios.min.js"></script>
<script type="text/javascript" src="/js/jquery/jquery.js"></script>

<script type="text/javascript" src="/js/bootstrap/popper.js"></script>
<script type="text/javascript" src="/js/bootstrap/bootstrap.min.js" ></script>

<script type="text/javascript" src="/js/vue/vue.js" ></script>
<script type="text/javascript" src="/js/vue/vuetable/vuetable-2-full.js" ></script>

<script type="text/javascript" src="/js/g2/g2.js" ></script>
<script type="text/javascript" src="/js/g2/data-set.js" ></script>

<script type="text/javascript" src="/js/common/md5.min.js"></script>
<script type="text/javascript" src="/js/common/base64.js"></script>
<script type="text/javascript" src="/js/common/pako.min.js"></script>

<script type="text/javascript" src="/js/common/loader.js"> </script>
<script type="text/javascript" src="/js/common/util.js"></script>


<script type="text/javascript">

    let suffix = QLoader.get_cookie_val("_u_js");
    if (window.location.href.indexOf("debug") > 0) {
        suffix = new Date().getTime();
    }
    QLoader.fetch_html_fragment_and_js(".qam-html-fragment", suffix, [
        "/js/common/util.js",
        "/js/db/db.js",
        "coldef.js",
        "q-chart-k.js",
        "q-stock.js",
        "q-script.js",
        "q-portfolio.js",
        "q.js"
    ]);

    QLoader.fetch_if('/js/eruda/eruda.js', "", {
        "url" : "eruda"
    }).then(function () {
        if (typeof eruda !== 'undefined') {
            eruda.init();
        }
    });

</script>
</body>
</html>